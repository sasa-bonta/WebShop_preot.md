{% extends 'base.html.twig' %}

{% block title %}Product{% endblock %}

{% block body %}
    <header>
        <img class="img-fluid" src="{{ asset('assets/main/images/header-image.jpg') }}" width="2000" alt="1">
    </header>

    <div>
        {# Navigation bar HERE #}
        {% include 'navbar.html.twig' %}

        <div id="product-images">
            {# Product code #}
            <br><br>
            <p id="product-code">#{{ product.code }}</p>
            {# Name #}
            <br>
            <h1 id="product-name"><b>{{ product.name }}</b></h1>
            <br><br>

            {# Galery #}
            <div class="custom-container">
                <div class="backImage">

                </div>
                <img id="expandedImg" style="width:100%">
            </div>

            <script>
                function myFunction(imgs) {
                    var expandImg = document.getElementById("expandedImg");
                    expandImg.src = imgs.src;
                    expandImg.parentElement.style.display = "block";
                }
            </script>
            <div class="row lowerImages">
                {% for path in product.imgPath %}
                    {% set fullImagePath = 'assets/main/images/gallery/' %}
                    {% set fullImagePath = fullImagePath ~ path %}

                    {% if loop.index == 1 %}
                        <div class="column">
                            <img src="{{ asset(fullImagePath) }}" alt="Image 1" style="width:100%"
                                 onclick="myFunction(this);" onload="myFunction(this);">
                        </div>
                    {% else %}
                        <div class="column">
                            <img src="{{ asset(fullImagePath) }}" alt="Image 2"
                                 style="width:100%"
                                 onclick="myFunction(this);">
                        </div>
                    {% endif %}

                {% endfor %}
            </div>
            {# Description #}
            <br><br>
            <p id="description">{{ product.description }}</p>

            {# Price #}
            <br><br>
            <div class="row-price-add">
                <p id="price"><b>{{ product.price | number_format(2) }} $</b></p>
                {% if is_granted('IS_AUTHENTICATED_REMEMBERED') %}
                    <button id="add-to-cart" class="add-to-cart btn btn-success" data-productCode="{{ product.code }}">
                        <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16"
                             fill="currentColor"
                             class="bi bi-cart-fill" viewBox="0 0 16 16">
                            <path d="M0 1.5A.5.5 0 0 1 .5 1H2a.5.5 0 0 1 .485.379L2.89 3H14.5a.5.5 0 0 1 .491.592l-1.5 8A.5.5 0 0 1 13 12H4a.5.5 0 0 1-.491-.408L2.01 3.607 1.61 2H.5a.5.5 0 0 1-.5-.5zM5 12a2 2 0 1 0 0 4 2 2 0 0 0 0-4zm7 0a2 2 0 1 0 0 4 2 2 0 0 0 0-4zm-7 1a1 1 0 1 1 0 2 1 1 0 0 1 0-2zm7 0a1 1 0 1 1 0 2 1 1 0 0 1 0-2z"/>
                        </svg>
                        <b>Add</b>
                    </button>
                {% else %}
                    <a href="{{ path('app_login') }}">
                        <button class="btn btn-success">
                            <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16"
                                 fill="currentColor"
                                 class="bi bi-cart-fill" viewBox="0 0 16 16">
                                <path d="M0 1.5A.5.5 0 0 1 .5 1H2a.5.5 0 0 1 .485.379L2.89 3H14.5a.5.5 0 0 1 .491.592l-1.5 8A.5.5 0 0 1 13 12H4a.5.5 0 0 1-.491-.408L2.01 3.607 1.61 2H.5a.5.5 0 0 1-.5-.5zM5 12a2 2 0 1 0 0 4 2 2 0 0 0 0-4zm7 0a2 2 0 1 0 0 4 2 2 0 0 0 0-4zm-7 1a1 1 0 1 1 0 2 1 1 0 0 1 0-2zm7 0a1 1 0 1 1 0 2 1 1 0 0 1 0-2z"/>
                            </svg>
                            Add
                        </button>
                    </a>
                {% endif %}
            </div>
            {# Availability #}
            <br>
            <p id="avail">Availability: {{ product.availableAmount ? 'in stock' : 'out of stock' }}</p>
        </div>
        {# Footer #}
        {% include 'footer.html.twig' %}
    </div>
{% endblock %}